Create new module - MetaMorpher
Create new doctype - City
	Field: City Name
	Type: Data
	Autoname: field:city_name
	Form settings: Allow import
Reload
Customize form: Project

Make "series" readonly
	Label				Type	Options
	Project Year		Select	25/26/27
	City				Link	City
	Project Category	Select	Residential/Commercial
Reload

Settings ‚Üí Server Scripts ‚Üí New
	Name: create project id
	Type: DocType Event
	DocType: Project
	Event: Before Insert



# DO NOT import anything (Server Scripts are sandboxed)

year = doc.custom_project_year
city = doc.custom_city
category = doc.custom_project_category
client = doc.customer   # using Client (Customer doctype)

def clean(val):
    return val.replace(" ", "_") if val else "XXX"

year = clean(year)
city = clean(city)
category = clean(category)
client = clean(client)

# Count existing projects for this year
count = frappe.db.count(
    "Project",
    {
        "custom_project_year": year
    }
)

seq = str(count + 1).zfill(3)

project_name = f"{year}-{seq}-{client}-{city}-{category}"

doc.project_name = project_name
doc.name = project_name   # THIS IS THE FIX









Client Script (Live Preview)
üìç Settings ‚Üí Client Scripts ‚Üí New
Client Script Settings
DocType: Project
apply to: form
Enabled: yes


frappe.ui.form.on("Project", {
    refresh(frm) {
        update_preview(frm);
    },
    custom_project_year: update_preview,
    custom_city: update_preview,
    custom_project_category: update_preview,
    customer: update_preview
});

function clean(val) {
    return val ? val.replaceAll(" ", "_") : "XXX";
}

function update_preview(frm) {
    if (frm.is_new()) {
        const year = clean(frm.doc.custom_project_year);
        const city = clean(frm.doc.custom_city);
        const cat  = clean(frm.doc.custom_project_category);
        const cli  = clean(frm.doc.customer);

        frm.set_value(
            "project_name",
            `${year}-XXX-${cli}-${city}-${cat}`
        );
    }
}
